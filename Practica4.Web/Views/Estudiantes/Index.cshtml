@model List<Practica4.DAL.Estudiante>   


<h2>Gestión de Estudiantes</h2>

<button class="btn btn-primary" onclick="openCreateModal()">Nuevo Estudiante</button>

<br />
<br />

<table class="table table-bordered" id="tablaEstudiantes">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Apellido</th>
            <th>Edad</th>
            <th>Correo</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<!-- Modal para Crear/Editar Estudiante -->
<div class="modal fade" id="modalEstudiante">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <h4 id="modalTitulo"></h4>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">

                <input type="hidden" id="Id" />

                <label>Nombre</label>
                <input type="text" class="form-control" id="Nombre" />

                <label>Apellido</label>
                <input type="text" class="form-control" id="Apellido" />

                <label>Edad</label>
                <input type="number" class="form-control" id="Edad" />

                <label>Correo</label>
                <input type="email" class="form-control" id="Correo" />

            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button class="btn btn-success" id="btnGuardar" onclick="save()">Guardar</button>
            </div>

        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        loadEstudiantes();
    });

    // Cargar estudiantes
    function loadEstudiantes() {
        $.get("/Estudiantes/GetAll", function (data) {
            let rows = "";
            $.each(data, function (i, est) {
                rows += `
                    <tr>
                        <td>${est.Id}</td>
                        <td>${est.Nombre}</td>
                        <td>${est.Apellido}</td>
                        <td>${est.Edad}</td>
                        <td>${est.Correo}</td>
                        <td>
                            <button class="btn btn-warning" onclick="edit(${est.Id})">Editar</button>
                            <button class="btn btn-danger" onclick="remove(${est.Id})">Eliminar</button>
                        </td>
                    </tr>
                `;
            });
            $("#tablaEstudiantes tbody").html(rows);
        });
    }

    // Abrir modal para crear
    function openCreateModal() {
        $("#modalTitulo").text("Nuevo Estudiante");
        $("#Id").val(0);
        $("#Nombre").val("");
        $("#Apellido").val("");
        $("#Edad").val("");
        $("#Correo").val("");
        $("#modalEstudiante").modal("show");
    }

    // Guardar (Create o Update)
    function save() {
        let estudiante = {
            Id: $("#Id").val(),
            Nombre: $("#Nombre").val(),
            Apellido: $("#Apellido").val(),
            Edad: $("#Edad").val(),
            Correo: $("#Correo").val()
        };

        let url = estudiante.Id == 0 ? "/Estudiantes/Create" : "/Estudiantes/Update";

        $.post(url, estudiante, function () {
            $("#modalEstudiante").modal("hide");
            loadEstudiantes();
        });
    }

    // Editar
    function edit(id) {
        $.get("/Estudiantes/GetById/" + id, function (est) {
            $("#modalTitulo").text("Editar Estudiante");
            $("#Id").val(est.Id);
            $("#Nombre").val(est.Nombre);
            $("#Apellido").val(est.Apellido);
            $("#Edad").val(est.Edad);
            $("#Correo").val(est.Correo);
            $("#modalEstudiante").modal("show");
        });
    }

    // Eliminar
    function remove(id) {
        if (confirm("¿Desea eliminar este registro?")) {
            $.post("/Estudiantes/Delete", { id: id }, function () {
                loadEstudiantes();
            });
        }
    }
</script>

